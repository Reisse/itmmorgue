// vim: sw=4 ts=4 et :
#include "itmmorgue.h"
#include "client.h"

void splash_screen() {
    WINDOW *splash;
    if ((splash = newwin(0, 0, 0, 0)) == NULL) {
        panic("Unable to create splash window!");
    }
    nodelay(splash, FALSE);

    for (int i = max_y - 1; i >= 0; i--) {
        w_color(splash, 8 + i % 8);
        mvwprintw(splash, i, 0, ".");
        for (int j = 1; j < max_x; j++) {
            wprintw(splash, ".");
        }
        wrefresh(splash);
        usleep(20000);
    }

    werase(splash);
    wrefresh(splash);

    int splash_delay = conf("splash_delay").ival;

    int A = 0, B = 0, C = 0, D = 0;
    B -= 10; D -= 10;

    // Logo dimensions: [0,8]x[0,38] [0,8]x[38,72]

    if (max_x <= 72 || max_y <= 8) {
        mvwprintw(splash, 
                (int)(max_y / 2) - 1,
                (int)(max_x / 2) - 4,
                "ITMMORGUE"
                );
        wrefresh(splash);
        goto nosplash;
    } else {
        A += (int)(max_y / 2) - 4;
        B += (int)(max_x / 2) - 38;
        C += (int)(max_y / 2) - 4;
        D += (int)(max_x / 2) - 38;
    }

#define s(y1, x1, c1, y2, x2, c2)  \
    w_color(splash, L_RED);        \
    mvwprintw(splash, y1, x1, c1); \
    w_color(splash, L_BLUE);       \
    mvwprintw(splash, y2, x2, c2); \
    wrefresh(splash);              \
    usleep(splash_delay);

    s(    A+0,    B+43,     "-",    C+0,    D+48,     "-");
    s(    A+0,    B+42,     "-",    C+0,    D+49,     "-");
    s(    A+0,    B+41,     "-",    C+0,    D+50,     "-");
    s(    A+0,    B+40,     "-",    C+1,    D+50,     "|");
    s(    A+1,    B+40,     "|",    C+2,    D+50,     "|");
    s(    A+2,    B+40,     "|",    C+3,    D+50,     "|");
    s(    A+3,    B+40,     "|",    C+4,    D+50,     "|");
    s(    A+4,    B+40,     "|",    C+5,    D+50,     "|");
    s(    A+5,    B+40,     "|",    C+6,    D+50,     "|");
    s(    A+6,    B+40,     "|",    C+7,    D+50,     "|");
    s(    A+7,    B+40,     "|",    C+8,    D+50,     "-");
    s(    A+8,    B+40,     "-",    C+8,    D+51,     "-");
    s(    A+8,    B+39,     "-",    C+8,    D+52,     "-");
    s(    A+8,    B+38,     "-",    C+7,    D+52,     "|");
    s(    A+7,    B+38,     "|",    C+6,    D+52,     "|");
    s(    A+6,    B+38,     "|",    C+5,    D+52,     "|");
    s(    A+5,    B+38,     "|",    C+4,    D+52,     "|");
    s(    A+4,    B+38,     "|",    C+4,    D+53,    "\\");
    s(    A+4,    B+37,     "/",    C+5,    D+54,    "\\");
    s(    A+4,    B+36,    "\\",    C+6,    D+55,     "|");
    s(    A+4,    B+35,     "|",    C+7,    D+55,     "|");
    s(    A+5,    B+35,     "|",    C+8,    D+55,     "-");
    s(    A+6,    B+35,     "|",    C+8,    D+56,     "-");
    s(    A+7,    B+35,     "|",    C+8,    D+57,     "-");
    s(    A+8,    B+35,     "-",    C+7,    D+57,     "|");
    s(    A+8,    B+34,     "-",    C+6,    D+57,     "|");
    s(    A+8,    B+33,     "-",    C+5,    D+56,    "\\");
    s(    A+7,    B+33,     "|",    C+4,    D+56,     "/");
    s(    A+6,    B+33,     "|",    C+3,    D+57,     "/");
    s(    A+5,    B+33,     "|",    C+2,    D+57,    "\\");
    s(    A+4,    B+33,     "|",    C+2,    D+56,     "-");
    s(    A+3,    B+33,     "|",    C+3,    D+55,     "/");
    s(    A+2,    B+33,     "|",    C+3,    D+54,    "\\");
    s(    A+1,    B+33,     "|",    C+2,    D+54,     "/");
    s(    A+0,    B+33,     "-",    C+2,    D+55,    "\\");
    s(    A+0,    B+32,     "-",    C+2,    D+56,     "=");
    s(    A+0,    B+31,     "-",    C+1,    D+56,    "\\");
    s(    A+1,    B+31,     "|",    C+0,    D+56,     "-");
    s(    A+2,    B+31,     "|",    C+0,    D+57,     "-");
    s(    A+3,    B+31,     "|",    C+0,    D+58,     "-");
    s(    A+4,    B+31,     "|",    C+0,    D+59,     "-");
    s(    A+5,    B+31,     "|",    C+0,    D+60,     "-");
    s(    A+6,    B+31,     "|",    C+1,    D+60,     "/");
    s(    A+7,    B+31,     "|",    C+2,    D+60,     "|");
    s(    A+8,    B+31,     "-",    C+3,    D+60,     "|");
    s(    A+8,    B+30,     "-",    C+4,    D+60,     "|");
    s(    A+8,    B+29,     "-",    C+5,    D+60,     "|");
    s(    A+7,    B+29,     "|",    C+6,    D+60,     "|");
    s(    A+6,    B+29,     "|",    C+7,    D+60,    "\\");
    s(    A+5,    B+29,     "|",    C+8,    D+61,     "-");
    s(    A+4,    B+29,     "|",    C+8,    D+62,     "-");
    s(    A+4,    B+28,     "/",    C+8,    D+63,     "-");
    s(    A+4,    B+27,    "\\",    C+8,    D+64,     "-");
    s(    A+4,    B+26,     "|",    C+8,    D+65,     "-");
    s(    A+5,    B+26,     "|",    C+7,    D+66,     "/");
    s(    A+6,    B+26,     "|",    C+6,    D+66,     "|");
    s(    A+7,    B+26,     "|",    C+5,    D+66,     "|");
    s(    A+8,    B+26,     "-",    C+4,    D+65,     "_");
    s(    A+8,    B+25,     "-",    C+4,    D+64,     "_");
    s(    A+8,    B+24,     "-",    C+5,    D+63,     "|");
    s(    A+7,    B+24,     "|",    C+5,    D+64,     "_");
    s(    A+6,    B+24,     "|",    C+6,    D+64,     "|");
    s(    A+5,    B+24,     "|",    C+6,    D+63,     "_");
    s(    A+4,    B+24,     "|",    C+6,    D+62,     "|");
    s(    A+3,    B+24,     "|",    C+5,    D+62,     "|");
    s(    A+2,    B+24,     "|",    C+4,    D+62,     "|");
    s(    A+1,    B+24,     "|",    C+3,    D+62,     "|");
    s(    A+0,    B+24,     "-",    C+2,    D+62,     "|");
    s(    A+0,    B+23,     "-",    C+1,    D+63,     "_");
    s(    A+1,    B+22,     "/",    C+2,    D+64,     "|");
    s(    A+1,    B+21,     "_",    C+2,    D+65,     "_");
    s(    A+2,    B+20,     "|",    C+2,    D+66,     "|");
    s(    A+3,    B+20,     "|",    C+1,    D+66,    "\\");
    s(    A+4,    B+20,     "|",    C+0,    D+66,     "-");
    s(    A+5,    B+20,     "|",    C+0,    D+67,     "-");
    s(    A+6,    B+20,     "|",    C+0,    D+68,     "-");
    s(    A+7,    B+20,     "|",    C+0,    D+69,     "-");
    s(    A+8,    B+20,     "-",    C+1,    D+68,     "/");
    s(    A+8,    B+19,     "-",    C+2,    D+68,     "|");
    s(    A+8,    B+18,     "-",    C+3,    D+68,     "|");
    s(    A+7,    B+18,     "|",    C+4,    D+68,     "|");
    s(    A+6,    B+18,     "|",    C+5,    D+68,     "|");
    s(    A+5,    B+18,     "|",    C+6,    D+68,     "|");
    s(    A+4,    B+18,     "|",    C+7,    D+68,    "\\");
    s(    A+3,    B+18,     "|",    C+8,    D+69,     "-");
    s(    A+2,    B+18,     "|",    C+8,    D+70,     "-");
    s(    A+1,    B+17,     "_",    C+8,    D+71,     "-");
    s(    A+1,    B+16,    "\\",    C+8,    D+72,     "-");
    s(    A+0,    B+15,     "-",    C+8,    D+73,     "-");
    s(    A+1,    B+14,     "/",    C+7,    D+74,     "/");
    s(    A+2,    B+13,     "|",    C+6,    D+74,     "|");
    s(    A+3,    B+13,     "|",    C+5,    D+74,     "|");
    s(    A+4,    B+13,     "|",    C+4,    D+74,     "|");
    s(    A+5,    B+13,     "|",    C+3,    D+74,     "|");
    s(    A+6,    B+13,     "|",    C+2,    D+74,     "|");
    s(    A+7,    B+14,    "\\",    C+1,    D+74,    "\\");
    s(    A+8,    B+14,     "-",    C+0,    D+73,     "-");
    s(    A+8,    B+13,     "-",    C+0,    D+74,     "-");
    s(    A+8,    B+12,     "-",    C+0,    D+75,     "-");
    s(    A+8,    B+11,     "-",    C+0,    D+76,     "-");
    s(    A+8,    B+10,     "-",    C+1,    D+76,     "|");
    s(    A+7,    B+10,     "/",    C+2,    D+76,     "|");
    s(    A+6,    B+11,     "|",    C+3,    D+76,     "|");
    s(    A+5,    B+11,     "|",    C+4,    D+76,     "|");
    s(    A+4,    B+11,     "|",    C+5,    D+76,     "|");
    s(    A+3,    B+11,     "|",    C+6,    D+76,     "|");
    s(    A+2,    B+11,     "|",    C+7,    D+76,     "|");
    s(    A+1,    B+10,    "\\",    C+8,    D+76,     "-");
    s(    A+0,    B+10,     "-",    C+8,    D+77,     "-");
    s(    A+0,    B+11,     "-",    C+8,    D+78,     "-");
    s(    A+0,    B+12,     "-",    C+8,    D+79,     "-");
    s(    A+0,    B+13,     "-",    C+8,    D+80,     "-");
    s(    A+0,    B+14,     "-",    C+8,    D+81,     "-");
    s(    A+0,    B+15,     "=",    C+8,    D+82,     "-");
    s(    A+0,    B+16,     "-",    C+7,    D+82,    "\\");
    s(    A+0,    B+17,     "-",    C+6,    D+81,     "_");
    s(    A+0,    B+18,     "-",    C+6,    D+80,     "_");
    s(    A+0,    B+19,     "-",    C+6,    D+79,     "_");
    s(    A+0,    B+20,     "-",    C+6,    D+78,     "|");
    s(    A+0,    B+21,     "-",    C+5,    D+78,     "|");
    s(    A+0,    B+22,     "-",    C+4,    D+79,     "_");
    s(    A+0,    B+23,     "=",    C+4,    D+80,     "_");
    s(    A+0,    B+24,     "-",    C+4,    D+81,     "|");
    s(    A+0,    B+25,     "-",    C+3,    D+80,     "_");
    s(    A+1,    B+26,    "\\",    C+3,    D+79,     "_");
    s(    A+2,    B+27,    "\\",    C+3,    D+78,     "|");
    s(    A+2,    B+28,     "/",    C+2,    D+78,     "|");
    s(    A+1,    B+29,     "/",    C+1,    D+79,     "_");
    s(    A+0,    B+30,     "-",    C+1,    D+80,     "_");
    s(    A+0,    B+31,     "-",    C+1,    D+81,     "_");
    s(    A+0,    B+32,     "=",    C+1,    D+82,     "/");
    s(    A+0,    B+33,     "-",    C+0,    D+82,     "-");
    s(    A+0,    B+34,     "-",    C+0,    D+81,     "-");
    s(    A+1,    B+35,    "\\",    C+0,    D+80,     "-");
    s(    A+2,    B+36,    "\\",    C+0,    D+79,     "-");
    s(    A+2,    B+37,     "/",    C+0,    D+78,     "-");
    s(    A+1,    B+38,     "/",    C+0,    D+77,     "-");
    s(    A+0,    B+39,     "-",    C+0,    D+76,     "-");
    s(    A+0,    B+40,     "-",    C+0,    D+75,     "=");
    s(    A+0,    B+41,     "=",    C+0,    D+74,     "=");
    s(    A+0,    B+42,     "=",    C+0,    D+73,     "=");
    s(    A+0,    B+43,     "=",    C+1,    D+72,     "/");
    s(    A+1,    B+42,     "/",    C+2,    D+72,     "|");
    s(    A+2,    B+42,     "|",    C+3,    D+72,     "|");
    s(    A+3,    B+42,     "|",    C+4,    D+72,     "|");
    s(    A+4,    B+42,     "|",    C+5,    D+72,     "|");
    s(    A+4,    B+43,     "-",    C+6,    D+72,     "|");
    s(    A+5,    B+44,     "|",    C+6,    D+71,     "_");
    s(    A+6,    B+44,     "|",    C+6,    D+70,     "|");
    s(    A+6,    B+45,     "_",    C+5,    D+70,     "|");
    s(    A+6,    B+46,     "|",    C+4,    D+70,     "|");
    s(    A+5,    B+46,     "|",    C+3,    D+70,     "|");
    s(    A+4,    B+46,     "|",    C+2,    D+70,     "|");
    s(    A+3,    B+46,     "|",    C+1,    D+70,    "\\");
    s(    A+2,    B+46,     "|",    C+0,    D+69,     "=");
    s(    A+1,    B+45,     "_",    C+0,    D+68,     "=");
    s(    A+2,    B+44,     "|",    C+0,    D+67,     "=");
    s(    A+3,    B+44,     "|",    C+0,    D+66,     "=");
    s(    A+4,    B+44,     "|",    C+0,    D+65,     "-");
    s(    A+4,    B+43,     "=",    C+0,    D+64,     "-");
    s(    A+5,    B+42,     "|",    C+0,    D+63,     "-");
    s(    A+6,    B+42,     "|",    C+0,    D+62,     "-");
    s(    A+7,    B+42,    "\\",    C+0,    D+61,     "-");
    s(    A+8,    B+43,     "-",    C+0,    D+60,     "=");
    s(    A+8,    B+44,     "-",    C+0,    D+59,     "=");
    s(    A+8,    B+45,     "-",    C+0,    D+58,     "=");
    s(    A+8,    B+46,     "-",    C+0,    D+57,     "=");
    s(    A+8,    B+47,     "-",    C+0,    D+56,     "=");
    s(    A+7,    B+48,     "/",    C+0,    D+55,     "-");
    s(    A+6,    B+48,     "|",    C+0,    D+54,     "-");
    s(    A+5,    B+48,     "|",    C+1,    D+53,     "/");
    s(    A+4,    B+48,     "|",    C+1,    D+52,    "\\");
    s(    A+3,    B+48,     "|",    C+0,    D+51,     "-");
    s(    A+2,    B+48,     "|",    C+0,    D+50,     "=");
    s(    A+1,    B+48,    "\\",    C+0,    D+49,     "=");
    s(    A+0,    B+47,     "-",    C+0,    D+48,     "@");
    s(    A+0,    B+46,     "-",    C+0,    D+48,     "@");
    s(    A+0,    B+45,     "-",    C+0,    D+48,     "@");
    s(    A+0,    B+44,     "-",    C+0,    D+48,     "@");
    s(    A+0,    B+44,     "=",    C+0,    D+48,     "@");
    s(    A+0,    B+45,     "=",    C+0,    D+48,     "@");
    s(    A+0,    B+46,     "=",    C+0,    D+48,     "@");
    s(    A+0,    B+47,     "@",    C+0,    D+48,     "@");

#undef s

nosplash:
    usleep( conf("splash_time").ival );

    delwin(splash);
}

